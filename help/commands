https://robertoprevato.github.io/Validating-JWT-Bearer-tokens-from-Azure-AD-in-Python/

python -m build

# if __name__ == "__main__":
#     obj = JWKSHandler("0159e9d0-09a0-4edf-96ba-a3deea363c28")
#     #obj.set_name_of_policy("b2c_1a_giadataportal__signup_signin")
#     jwks_keys = obj.get_jwks_keys()
#     print(jwks_keys)


if __name__ == "__main__":
    jwt_validator = JWTValidator("0159e9d0-09a0-4edf-96ba-a3deea363c28")
    #jwt_validator.set_name_of_policy("b2c_1a_giadataportal__signup_signin")
    is_valid, token = jwt_validator.validate("eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ik9fRDU3T3Vuc0pwX3NEcTc5bkpOdmJ2aExQVTFoLVpSSVZFX3JPVThTMUEifQ.eyJleHAiOjE2NjE0NjU5MjksIm5iZiI6MTY2MTQ2MjMyOSwidmVyIjoiMS4wIiwiaXNzIjoiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tLzYyMTA1ZDJhLTQ4YTAtNDY1MS04ZDg0LTVhNWUxOTdmYmEwMy8iLCJzdWIiOiJEaW5lc2guU2luZ2hAY2JyZS5jby5pbiIsImF1ZCI6IjJmZWNkYmJmLWFkYWQtNGVkMC1iMTA1LTlhZTkzYTUyNWE0MiIsImFjciI6ImIyY18xYV9naWFkYXRhcG9ydGFsX19zaWdudXBfc2lnbmluIiwibm9uY2UiOiIwZWUyMTMyZC1jZjA0LTQzYTAtYjE4NS0yMjg4NjE3OGUwYmQiLCJpYXQiOjE2NjE0NjIzMjksImF1dGhfdGltZSI6MTY2MTQ2MjMyOSwiZ2l2ZW5fbmFtZSI6IkRpbmVzaCIsImZhbWlseV9uYW1lIjoiS3VzaHdhaGEiLCJuYW1lIjoiU2luZ2gsIERpbmVzaCBAIEd1cmdhb24iLCJ1bmlxdWVfbmFtZSI6IkRpbmVzaC5TaW5naEBjYnJlLmNvLmluIiwiaWRwIjoiQXp1cmVBRFdvcmsiLCJ0ZXJtc2FjY2VwdGVkIjpmYWxzZSwicHJpdmFjeWFjY2VwdGVkIjpmYWxzZX0.Gp3inrBFUSoavv_Yghf3YSiTlIwCwlezhls6w653HHBRrPfmGBisG_02D0DUJFr5RIC2JsUJNAf0wENWMoAI2b5yFNFK0P3Q3L80AEIbrI5sITzWEuMJcmDGvusocUibFsQJHhBOjmciBu-S_IBpelU4mld6h1Soe1CjGGJhTQ78OqC7A4M2CAn362UTMUDucqHsgH_n5MXgMgEa5ENVDqSbQgyMBMhxHurHtxbyNBcxaRoVsmdVltKtZkdxntzGIFqihZ-GrhV1qqi_xCYe-GivPR8Rh8fqE-LGXJJpFOq5cIDHTg9oW2e5vOd-aPnFyHGfEoYz_mFyn9cbKRR1Fg")
    print(is_valid)
    print(token)


